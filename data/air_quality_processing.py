import pandas as pd
# Set threshold for PM2.5, PM10, NO2, O3, SO2, CO
AQI_RANGES = {
    'pm2_5': [
        (0.0, 12.0, 0, 50),
        (12.1, 35.4, 51, 100),
        (35.5, 55.4, 101, 150),
        (55.5, 150.4, 151, 200),
        (150.5, 250.4, 250.5, 500.4)
    ],
    'pm10': [
        (0.0, 54.0, 0, 50),
        (55.0, 154.0, 51, 100),
        (155.0, 254.0, 101, 150),
        (255.0, 354.0, 151, 200),
        (355.0, 424.0, 201, 300),
        (425.0, 604.0, 301, 500)
    ],
    'no2': [
        (0.0, 53.0, 0, 50),
        (55.0, 70.0, 51, 100),
        (71.0, 85.0, 101, 150),
        (86.0, 105.0, 151, 200),
        (106.0, 200.0, 201, 300),
        (201.0, 604.0, 301, 500)
    ],
    'o3': [
        (0.0, 54.0, 0, 50),
        (55.0, 70.0, 51, 100),
        (71.0, 85.0, 101, 150),
        (86.0, 105.0, 151, 200),
        (106.0, 200.0, 201, 300),
        (201.0, 604.0, 301, 500)
    ],
    'so2': [
        (0.0, 35.0, 0, 50),
        (36.0, 75.0, 51, 100),
        (76.0, 185.0, 101, 150),
        (186.0, 304.0, 151, 200),
        (305.0, 604.0, 201, 300),
        (605.0, 1000.0, 301, 500)
    ],
    'co' : [
        (0.0, 35.0, 0, 50),
        (36.0, 75.0, 51, 100),
        (76.0, 185.0, 101, 150),
        (186.0, 304.0, 151, 200),
        (305.0, 604.0, 201, 300),
        (605.0, 1000.0, 301, 500)
    ],
}

# AQI computing function
def calculate_AQI(C, ranges):
  for C_low, C_high, I_low, I_high in ranges:
    if C_low <= C <= C_high:
      # calculate AQI
      return ((C - C_low) / (C_high - C_low)) * (I_high - I_low) + I_low
  return None

def calculate_all_AQIs(df, column, aqi_ranges):
  return df[column].apply(lambda C: calculate_AQI(C, aqi_ranges))

def calculate_overall_AQI(df, columns):
  return df[columns].max(axis=1)

